include(../lib/html/optinomic/page/start.m4)
<md-content ng-if="d.haveData">
    <div ng-if="!d.zScore.init">
        <h3 class="md-headline">TMT</h3>
        <h3 class="md-subhead">Berechnung wird ausgeführt.</h3>
    </div>
    <div ng-if="d.zScore.init">
        <h3 class="md-headline">Normgruppen | Einstellungen</h3>
        <div layout="row" layout-align="space-between start" style="margin-top: 24px;">
            <div flex style="margin-right:12px;">
                <p class="md-title">{{d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.altersgruppe_text}} </p>
                <div layout="row" layout-align="space-between end">
                    <p flex="5" class="md-title" style="font-size:36px; color:#3F51B5!important;">■</p>
                    <p flex class="md-caption"> Die Z-Werte sind nach Alter und Bildung nach Tombaugh 2004 normiert. {{d.dataMain.patient.data.extras.name}} ({{d.dataMain.patient.data.extras.birthday}}); Alter bei Erfassung: {{d.dataMain.patient.data.extras.age}}; <span ng-if="d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.education_high">Hoher Ausbildsgrad</span><span ng-if="!d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.education_high">Nigriger Ausbildsgrad</span> ({{d.dataMain.survey_responses[0].calculations[0].calculation_result.edu_years}} Jahre).</p>
                </div>
                <p class="md-subhead">
                    {{d.zScore.normgruppe_tmt.edu_group.edu_group_text}} | n={{d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.n}}
                </p>
            </div>
            <div flex>
                <p class="md-title">{{d.dataMain.config.data.customer.contact.name}}</p>
                <div layout="row" layout-align="space-between end">
                    <p flex="5" class="md-title" style="font-size:36px; color:#C5CAE9!important;">■</p>
                    <p flex class="md-caption"> Die klinische Stichproben ({{d.dataMain.config.data.customer.contact.name}}) sind nach Alter und Bildung normiert.</p>
                </div>
                <div md-padding>
                    <md-input-container class="md-block">
                        <label>Alter</label>
                        <md-select ng-model="d.zScore.normgruppe_klinik.selected_age_group_id" ng-change="changeClinicSample()">
                            <md-option ng-repeat="age in d.zScore.user_app_calc.definitions.age" ng-value="age.age_group_id">
                                {{age.age_group_text}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                    <md-input-container class="md-block" style="margin-top:24px;">
                        <label>Bildung</label>
                        <md-select ng-model="d.zScore.normgruppe_klinik.selected_edu_group_id" ng-change="changeClinicSample()">
                            <md-option ng-repeat="edu in d.zScore.user_app_calc.definitions.edu" ng-value="edu.edu_group_id">
                                {{edu.edu_group_text}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                    <md-input-container class="md-block" style="margin-top:24px;">
                        <label>Messzeitpunkt</label>
                        <md-select ng-model="d.zScore.normgruppe_klinik.selected_mz_array" ng-change="changeClinicSample()">
                            <md-option ng-repeat="mz in d.zScore.normgruppe_klinik.select_mz_array" ng-value="mz.id">
                                {{mz.text}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                </div>
            </div>
        </div>
        <div class="grid-border-top" style="margin-top: 24px;">
            <div layout="row" layout-align="space-between end">
                <div flex>
                    <h3 class="md-headline">TMT A</h3>
                    <div ng-if="d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.altersgruppe_found">
                        <p class="md-subhead">{{d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.altersgruppe_text}}
                            <br> <span ng-if="d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.education_high">Hoher Ausbildsgrad (> 12 Jahre)</span><span ng-if="!d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.education_high">Nigriger Ausbildsgrad (<= 12 Jahre)</span> | n={{d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.n}}</p>
                    </div>
                </div>
                <div flex ng-if="d.zScore.normgruppe_klinik.selected_pg_id !==null">
                    <h3 class="md-subhead">{{d.dataMain.config.data.customer.contact.name}}</h3>
                    <p class="md-caption" style="margin-top:-12px;"><span ng-attr-style="font-size:24px; color:{{d.zScore.global.clinicsample_color}}!important;">■</span> {{d.zScore.normgruppe_klinik.selected_pg}}</p>
                </div>
            </div>
            <div layout="row" layout-align="space-between end">
                <div flex>
                    <md-switch class="md-primary" ng-model="d.zScore.toggles.show_text" ng-change="setZScore()" aria-label="Beschriftung">
                        Beschriftung
                    </md-switch>
                </div>
                <div flex ng-if="d.zScore.normgruppe_klinik.selected_pg_id !==null" layout="row" layout-align="space-between end">
                    <md-switch class="md-primary" ng-model="d.zScore.toggles.show_clinicsample" ng-change="setZScore()" aria-label="Zeige Klinische Stichprobe">
                        Klinische Stichprobe
                    </md-switch>
                    <md-switch class="md-primary" ng-if="d.zScore.toggles.show_clinicsample" ng-model="d.zScore.toggles.show_clinicsample_scores" ng-change="setZScore()" aria-label="Zeige Werte der Stichprobe">
                        Werte
                    </md-switch>
                </div>
            </div>
        </div>
        <div ng-repeat="response in d.zScore.tmt_a">
            <z-score data="response"></z-score>
        </div>
        <div layout="row" layout-align="space-between start" layout-margin ng-repeat="response in d.dataMain.survey_responses">
            <div layout="column" layout-align="start center" flex="20">
                <p class="md-caption">{{response.calculations[0].calculation_result.Messzeitpunkt.Messzeitpunkt_Text}}</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.entity.data.response.Date | date}}</p>
            </div>
            <div layout="column" layout-align="start center">
                <p class="md-caption">TMT A: Zeit</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.TMTATime}}</p>
            </div>
            <div layout="column" layout-align="start center">
                <p class="md-caption">TMT A: Fehler</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.TMTAError}}</p>
            </div>
            <div layout="column" layout-align="start center" ng-if="response.calculations[0].calculation_result.percentile.result.calculated">
                <p class="md-caption">TMT A: Perzentile</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.percentile.result.A}}</p>
            </div>
            <div layout="column" layout-align="start center">
                <p class="md-caption">B/A: Quotient</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.quotient_rounded}}</p>
            </div>
        </div>
        <div class="grid-border-top" style="margin-top: 24px;">
            <div layout="row" layout-align="space-between end">
                <div flex>
                    <h3 class="md-headline">TMT B</h3>
                    <div ng-if="d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.altersgruppe_found">
                        <p class="md-subhead">{{d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.altersgruppe_text}}
                            <br> <span ng-if="d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.education_high">Hoher Ausbildsgrad (> 12 Jahre)</span><span ng-if="!d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.education_high">Nigriger Ausbildsgrad (<= 12 Jahre)</span> | n={{d.dataMain.survey_responses[0].calculations[0].calculation_result.percentile.age_perz.n}}</p>
                    </div>
                </div>
                <div flex ng-if="d.zScore.normgruppe_klinik.selected_pg_id !==null">
                    <h3 class="md-subhead">{{d.dataMain.config.data.customer.contact.name}}</h3>
                    <p class="md-caption" style="margin-top:-12px;"><span ng-attr-style="font-size:24px; color:{{d.zScore.global.clinicsample_color}}!important;">■</span> {{d.zScore.normgruppe_klinik.selected_pg}}</p>
                </div>
            </div>
            <div layout="row" layout-align="space-between end">
                <div flex>
                    <md-switch class="md-primary" ng-model="d.zScore.toggles.show_text" ng-change="setZScore()" aria-label="Beschriftung">
                        Beschriftung
                    </md-switch>
                </div>
                <div flex ng-if="d.zScore.normgruppe_klinik.selected_pg_id !==null" layout="row" layout-align="space-between end">
                    <md-switch class="md-primary" ng-model="d.zScore.toggles.show_clinicsample" ng-change="setZScore()" aria-label="Zeige Klinische Stichprobe">
                        Klinische Stichprobe
                    </md-switch>
                    <md-switch class="md-primary" ng-if="d.zScore.toggles.show_clinicsample" ng-model="d.zScore.toggles.show_clinicsample_scores" ng-change="setZScore()" aria-label="Zeige Werte der Stichprobe">
                        Werte
                    </md-switch>
                </div>
            </div>
        </div>
        <div ng-repeat="response in d.zScore.tmt_b">
            <z-score data="response"></z-score>
        </div>
        <div ng-repeat="response in d.dataMain.survey_responses" layout="row" layout-align="space-between start" layout-margin>
            <div layout="column" layout-align="start center" flex="20">
                <p class="md-caption">{{response.calculations[0].calculation_result.Messzeitpunkt.Messzeitpunkt_Text}}</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.entity.data.response.Date | date}}</p>
            </div>
            <div layout="column" layout-align="start center">
                <p class="md-caption">TMT B: Zeit</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.TMTBTime}}</p>
            </div>
            <div layout="column" layout-align="start center">
                <p class="md-caption">TMT B: Fehler</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.TMTBError}}</p>
            </div>
            <div layout="column" layout-align="start center" ng-if="response.calculations[0].calculation_result.percentile.result.calculated">
                <p class="md-caption">TMT B: Perzentile</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.percentile.result.B}}</p>
            </div>
            <div layout="column" layout-align="start center">
                <p class="md-caption">B/A: Quotient</p>
                <p class="md-subhead" style="margin-top:-12px;">{{response.calculations[0].calculation_result.quotient_rounded}}</p>
            </div>
        </div>
    </div>
</md-content>
<div ng-if="!d.haveData">
    <h3 class="md-headline">Keine Daten</h3>
    <h3 class="md-subhead">Kein Assessment | Messungen vorhanden.</h3>
</div>
include(../lib/html/optinomic/page/end.m4)
