include(../lib/html/optinomic/page/start.m4)
<md-content class="md-padding">
    <md-card>
        <md-card-title style="background-color: #424242; color: #FAFAFA">
            <md-card-title-text>
                <span class="md-headline">
                    {{d.dataMain.params.app_name}}
                </span>
            </md-card-title-text>
        </md-card-title>
        <md-card-content layout-margin ng-if="d.init_stay.history_states.length === 0">
            <h1 class="md-title">Bitte spezifizieren Sie die aktuelle Behandlung. Danke!</h1>
        </md-card-content>
        <md-divider ng-if="d.init_stay.history_states.length === 0"></md-divider>
        <md-card-content layout-margin>
            <div>
                <div>&nbsp;</div>
                <md-input-container class="md-block">
                    <label>Behandlungsart</label>
                    <md-select class="md-title" ng-model="d.init_stay.selected.treatment_id" md-on-close="changeTreatment()">
                        <md-option ng-repeat="treatment in d.init_stay.treatment" value="{{treatment.id}}">
                            {{treatment.name}}
                        </md-option>
                    </md-select>
                </md-input-container>
            </div>
        </md-card-content>
        <md-divider></md-divider>
        <md-card-content layout-margin>
            <div>
                <h1 class="md-title">Behandlungen: {{d.init_stay.selected.treatment.description}}</h1>
                <md-list>
                    <md-list-item class="md-2-line" ng-repeat="department in d.init_stay.selected.treatment.departments">
                        <md-checkbox ng-model="department.current_patient.used" aria-label="{{department.current_patient.name}}">
                        </md-checkbox>
                        <div class="md-list-item-text">
                            <h3>{{department.name}}</h3>
                            <p>{{department.description}}</p>
                        </div>
                    </md-list-item>
                </md-list>
            </div>
        </md-card-content>
        <md-divider></md-divider>
        <md-card-content layout-margin ng-if="d.init_stay.history_states.length > 0">
            <div>
                <h1 class="md-title">Behandlungsgeschichte:</h1>
                <md-list>
                    <md-list-item class="md-2-line" ng-repeat="item in d.init_stay.history_states" ng-click="showDetails(item)">
                        <md-checkbox ng-disabled="true" ng-model="item.current" aria-label="Current">
                        </md-checkbox>
                        <div class="md-list-item-text">
                            <h3>{{item.data.treatment.name}} </h3>
                            <p>{{item.date}} {{item.time}}</p>
                        </div>
                    </md-list-item>
                </md-list>
            </div>
            <div ng-if="d.init_stay.show_details.show">
                <h1 class="md-title">Details: {{d.init_stay.show_details.data.data.name}} | {{d.init_stay.show_details.data.data.date}} {{d.init_stay.show_details.data.data.time}}</h1>
                <pre>{{d.init_stay.show_details.data.data | json}}</pre>
            </div>
        </md-card-content>
        <md-divider></md-divider>
        <md-card-content layout-margin>
            <p class="md-titel">Selktiert</p>
            <pre>{{d.init_stay.selected | json}}</pre>
            <p class="md-titel">Full</p>
            <pre>{{d.init_stay | json}}</pre>
        </md-card-content>
        <md-divider></md-divider>
        <md-card-actions layout-gt-xs="row" layout-align="start center">
            <md-button ng-click="saveInit();" class="md-warn">Speichern</md-button>
        </md-card-actions>
    </md-card>
</md-content>
include(../lib/html/optinomic/page/end.m4)
