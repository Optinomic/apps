-- Â© by Nora SchÃ¶nenberger, Klinik SÃ¼dhang --

SELECT

  -- START:  Optinoimc Default |  Needed for Export-Toolbox
  survey_response_view.patient_id as optinomic_patient_id,
  survey_response_view.stay_id as optinomic_stay_id,
  survey_response_view.event_id as optinomic_event_id,
  survey_response_view.survey_response_id as optinomic_survey_response_id,
  survey_response_view.filled as optinomic_survey_filled,
  ((cast(response AS json))->>'id') as optinomic_limesurvey_id,
  -- END:  Optinoimc Default |  Needed for Export-Toolbox

  stay.start as Klinikeintritt,
  stay.stop as Klinikaustritt,
   ((cast(response AS json))->>'Institution') as institution,
  stay.cis_fid/100 as vzex005,
  ((cast(response AS json))->>'VMEB001') as vmeb001,
  ((cast(response AS json))->>'VMEB005') as vmeb005,
  NULL as VMEB006,
  patient.four_letter_code as VMEB010,
  ((cast(response AS json))->>'VMEB040a') as vmeb040a,
  ((cast(response AS json))->>'VMEB040d') as vmeb040d,
  NULL as VMEB040g,


  CASE WHEN ((cast(response AS json))->>'VNEB050[VNEB050x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB050[VNEB050x]') END as vneb050_vneb050x,
  CASE WHEN ((cast(response AS json))->>'VNEB050[VNEB050y]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB050[VNEB050y]') END as vneb050_vneb050y,
  CASE WHEN ((cast(response AS json))->>'VNEB050[VNEB050a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB050[VNEB050a]') END as vneb050_vneb050a,
  CASE WHEN ((cast(response AS json))->>'VNEB050[VNEB050b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB050[VNEB050b]') END as vneb050_vneb050b,
  CASE WHEN ((cast(response AS json))->>'VNEB050[VNEB050c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB050[VNEB050c]') END as vneb050_vneb050c,
  CASE WHEN ((cast(response AS json))->>'VNEB050[VNEB050d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB050[VNEB050d]') END as vneb050_vneb050d,
  CASE WHEN ((cast(response AS json))->>'VNEB050[VNEB050e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB050[VNEB050e]') END as vneb050_vneb050e,

  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060x]') END as vneb060_vneb060x,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060a]') END as vneb060_vneb060a,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060b]') END as vneb060_vneb060b,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060c]') END as vneb060_vneb060c,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060d]') END as vneb060_vneb060d,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060e]') END as vneb060_vneb060e,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060f]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060f]') END as vneb060_vneb060f,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060g]') END as vneb060_vneb060g,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060h]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060h]') END as vneb060_vneb060h,
  CASE WHEN ((cast(response AS json))->>'VNEB060[VNEB060i]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEB060[VNEB060i]') END as vneb060_vneb060i,

  ((cast(response AS json))->>'VMEB061') as vmeb061,

  CASE WHEN ((cast(response AS json))->>'VNEB065') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNEB065') END as vneb065,
  CASE WHEN ((cast(response AS json))->>'VNEB066') = '999' THEN '-1' WHEN ((cast(response AS json))->>'VNEB066') = '1' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VNEB066') END as vneb066,

  ((cast(response AS json))->>'VNEB067') as vneb067,

  CASE WHEN ((cast(response AS json))->>'VYEE010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEE010') END as vyee010,
  CASE WHEN ((cast(response AS json))->>'QYEE020[VYEE020x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEE020[VYEE020x]') END as qyee020_vyee020x,
  CASE WHEN ((cast(response AS json))->>'QYEE020[VYEE020a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEE020[VYEE020a]') END as qyee020_vyee020a,
  CASE WHEN ((cast(response AS json))->>'QYEE020[VYEE020b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEE020[VYEE020b]') END as qyee020_vyee020b,
  CASE WHEN ((cast(response AS json))->>'QYEE020[VYEE020c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEE020[VYEE020c]') END as qyee020_vyee020c,
  CASE WHEN ((cast(response AS json))->>'QYEE020[VYEE020d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEE020[VYEE020d]') END as qyee020_vyee020d,

  ((cast(response AS json))->>'QZEE025') as vzee025,

  CASE WHEN ((cast(response AS json))->>'VYEE040') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEE040') END as vyee040,

  ((cast(response AS json))->>'VZEE041') as vzee041,

  CASE WHEN ((cast(response AS json))->>'VZEE050') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEE050') END as vzee050,
  CASE WHEN ((cast(response AS json))->>'VNEB080') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNEB080') END as vneb080,

  ((cast(response AS json))->>'VMEB081') as vmeb081,

  CASE WHEN patient.gender='Male' THEN '1' ELSE '2' END as VMEC010,

  patient.birthdate as VMEC020,
  NULL as VMEC021,
  ((cast(response AS json))->>'VMEC030a') as vmec030a,
  NULL as vmec030b,
  NULL as vmec030c,
  NULL as vmec030d,
  NULL as vmec030e,

  CASE WHEN ((cast(response AS json))->>'VMEC040') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VMEC040') END as vmec040,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050yy]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050yy]') END as VNEC050yy,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050ch]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050ch]') END as VNEC050ch,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050al]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050al]') END as VNEC050al,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050dz]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050dz]') END as VNEC050dz,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050de]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050de]') END as VNEC050de,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050at]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050at]') END as VNEC050at,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050ba]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050ba]') END as VNEC050ba,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050br]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050br]') END as VNEC050br,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050ca]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050ca]') END as VNEC050ca,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050hr]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050hr]') END as VNEC050hr,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050es]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050es]') END as VNEC050es,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050us]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050us]') END as VNEC050us,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050fr]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050fr]') END as VNEC050fr,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050gb]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050gb]') END as VNEC050gb,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050gr]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050gr]') END as VNEC050gr,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050hu]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050hu]') END as VNEC050hu,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050it]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050it]') END as VNEC050it,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050xk]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050xk]') END as VNEC050xk,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050mk]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050mk]') END as VNEC050mk,

  NULL as VNEC050ms,

  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050me]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050me]') END as VNEC050me,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050nl]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050nl]') END as VNEC050nl,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050pt]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050pt]') END as VNEC050pt,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050rs]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050rs]') END as VNEC050rs,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050lk]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050lk]') END as VNEC050lk,
  CASE WHEN ((cast(response AS json))->>'QNEC050[VNEC050tr]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC050[VNEC050tr]') END as VNEC050tr,
  CASE WHEN ((cast(response AS json))->>'VNEC050x') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'VNEC050x') END as VNEC050x,

  CASE WHEN ((cast(response AS json))->>'QNEC060QNEC065[VNEC060]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC060QNEC065[VNEC060]') END as vnec060,

  ((cast(response AS json))->>'VMEC061') as vmec061,

  CASE WHEN ((cast(response AS json))->>'QNEC060QNEC065[VNEC065]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC060QNEC065[VNEC065]') END as vnec065,

  ((cast(response AS json))->>'VMEC066') as vmec066,

  CASE WHEN ((cast(response AS json))->>'VNEC067') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNEC067') END as vnec067,
  CASE WHEN ((cast(response AS json))->>'VNEC068') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNEC068') END as vnec068,
  CASE WHEN ((cast(response AS json))->>'QNEC070QNEC075[VNEC070]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC070QNEC075[VNEC070]') END as vnec070,
  CASE WHEN ((cast(response AS json))->>'QNEC070QNEC075[VNEC075]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC070QNEC075[VNEC075]') END as vnec075,
  CASE WHEN ((cast(response AS json))->>'VZES010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZES010') END as vzes010,
  CASE WHEN ((cast(response AS json))->>'VZES015') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZES015') END as vzes015,
  CASE WHEN ((cast(response AS json))->>'VZES020') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZES020') END as vzes020,
  CASE WHEN ((cast(response AS json))->>'VZES050') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZES050') END as vzes050,
  CASE WHEN ((cast(response AS json))->>'QZES060QZES070[VZES060]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QZES060QZES070[VZES060]') END as vzes060,
  CASE WHEN ((cast(response AS json))->>'QZES060QZES070[VZES070]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QZES060QZES070[VZES070]') END as vzes070,
  CASE WHEN ((cast(response AS json))->>'QZES080[VZES080x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZES080[VZES080x]') END as VZES080x,
  CASE WHEN ((cast(response AS json))->>'QZES080[VZES080y]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZES080[VZES080y]') END as vzes080y,
  CASE WHEN ((cast(response AS json))->>'QZES080[VZES080a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZES080[VZES080a]') END as vzes080a,
  CASE WHEN ((cast(response AS json))->>'QZES080[VZES080b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZES080[VZES080b]') END as vzes080b,
  CASE WHEN ((cast(response AS json))->>'QZES080[VZES080c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZES080[VZES080c]') END as vzes080c,
  CASE WHEN ((cast(response AS json))->>'QZES080[VZES080d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZES080[VZES080d]') END as vzes080d,

  ((cast(response AS json))->>'VZES081') as vzes081,

  CASE WHEN ((cast(response AS json))->>'QNEC080QNEC090[VNEC080]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC080QNEC090[VNEC080]') END as vnec080,

  ((cast(response AS json))->>'VMEC081') as vmec081,

  CASE WHEN ((cast(response AS json))->>'QNEC080QNEC090[VNEC090]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC080QNEC090[VNEC090]') END as vnec090,

  ((cast(response AS json))->>'VMEC091') as vmec091,

  CASE WHEN ((cast(response AS json))->>'QNEC100QNEC110[VNEC100]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC100QNEC110[VNEC100]') END as vnec100,

  ((cast(response AS json))->>'VMEC101') as vmec101,

  CASE WHEN ((cast(response AS json))->>'QNEC100QNEC110[VNEC110]') = '999' THEN '-1' ELSE ((cast(response AS json))->>'QNEC100QNEC110[VNEC110]') END as vnec110,

  ((cast(response AS json))->>'VMEC111') as vmec111,

  CASE WHEN ((cast(response AS json))->>'VYEF010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEF010') END as vyef010,

  ((cast(response AS json))->>'VZEF011') as vzef011,

  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120x]') END as VNEC120x,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120y]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120y]') END as VNEC120y,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120a]') END as VNEC120a,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120b]') END as VNEC120b,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120c]') END as VNEC120c,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120d]') END as VNEC120d,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120e]') END as VNEC120e,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120f]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120f]') END as VNEC120f,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120g]') END as VNEC120g,
  CASE WHEN ((cast(response AS json))->>'QNEC120[VNEC120h]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNEC120[VNEC120h]') END as VNEC120h,
  CASE WHEN ((cast(response AS json))->>'VZEF030') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEF030') END as vzef030,
  CASE WHEN ((cast(response AS json))->>'VYEF040') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEF040') END as vyef040,
  CASE WHEN ((cast(response AS json))->>'QNED0701[VNED070a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0701[VNED070a]') END as vneD070a,
  CASE WHEN ((cast(response AS json))->>'QNED0702[VNED070ba]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0702[VNED070ba]') END as vneD070ba,
  CASE WHEN ((cast(response AS json))->>'QNED0702[VNED070bb]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0702[VNED070bb]') END as vneD070bb,
  CASE WHEN ((cast(response AS json))->>'QNED0702[VNeD070bc]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0702[VNeD070bc]') END as vneD070bc,
  CASE WHEN ((cast(response AS json))->>'QNED0702[VNED070bd]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0702[VNED070bd]') END as vneD070bd,
  CASE WHEN ((cast(response AS json))->>'QNED0702[VNED070be]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0702[VNED070be]') END as vneD070be,
  CASE WHEN ((cast(response AS json))->>'QNED0703[VNED070ca]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0703[VNED070ca]') END as vneD070ca,
  CASE WHEN ((cast(response AS json))->>'QNED0703[VNED070cb]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0703[VNED070cb]') END as vneD070cb,
  CASE WHEN ((cast(response AS json))->>'QNED0703[VNED070cc]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0703[VNED070cc]') END as vneD070cc,
  CASE WHEN ((cast(response AS json))->>'QNED0704[VNED070da]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0704[VNED070da]') END as vneD070da,
  CASE WHEN ((cast(response AS json))->>'QNED0704[VNED070db]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0704[VNED070db]') END as vneD070db,
  CASE WHEN ((cast(response AS json))->>'QNED0704[VNED070dc]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0704[VNED070dc]') END as vneD070dc,
  CASE WHEN ((cast(response AS json))->>'QNED0704[VNED070dd]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0704[VNED070dd]') END as vneD070dd,
  CASE WHEN ((cast(response AS json))->>'QNED0704[VNED070de]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0704[VNED070de]') END as vneD070de,
  CASE WHEN ((cast(response AS json))->>'QNED0705[VNED070ea]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0705[VNED070ea]') END as vneD070ea,
  CASE WHEN ((cast(response AS json))->>'QNED0705[VNED070eb]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0705[VNED070eb]') END as vneD070eb,
  CASE WHEN ((cast(response AS json))->>'QNED0705[VNED070ec]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0705[VNED070ec]') END as vneD070ec,
  CASE WHEN ((cast(response AS json))->>'QNED0705[VNED070ed]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0705[VNED070ed]') END as vneD070ed,
  CASE WHEN ((cast(response AS json))->>'QNED0706[VNED070fa]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0706[VNED070fa]') END as vneD070fa,
  CASE WHEN ((cast(response AS json))->>'QNED0706[VNED070fb]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0706[VNED070fb]') END as vneD070fb,
  CASE WHEN ((cast(response AS json))->>'QNED0706[VNED070fc]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0706[VNED070fc]') END as vneD070fc,
  CASE WHEN ((cast(response AS json))->>'QNED0707[VNED070g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0707[VNED070g]') END as vneD070g,
  CASE WHEN ((cast(response AS json))->>'QNED0707[VNED070h]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0707[VNED070h]') END as vneD070h,
  CASE WHEN ((cast(response AS json))->>'QNED0707[VNED070i]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0707[VNED070i]') END as vneD070i,
  CASE WHEN ((cast(response AS json))->>'QNED0707[VNED070j]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0707[VNED070j]') END as vneD070j,
  CASE WHEN ((cast(response AS json))->>'QNED0708[VNED070ka]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0708[VNED070ka]') END as vneD070ka,
  CASE WHEN ((cast(response AS json))->>'QNED0708[VNED070kb]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0708[VNED070kb]') END as vneD070kb,
  CASE WHEN ((cast(response AS json))->>'QNED0708[VNED070kc]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0708[VNED070kc]') END as vneD070kc,
  CASE WHEN ((cast(response AS json))->>'QNED0708[VNED070kd]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED0708[VNED070kd]') END as vneD070kd,
  CASE WHEN ((cast(response AS json))->>'VNED070x') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED070x') END as VNED070x,

  ((cast(response AS json))->>'VNED071be') as vned071be,
  ((cast(response AS json))->>'VNED071cc') as vned071cc,
  ((cast(response AS json))->>'VNED071de') as vned071de,
  ((cast(response AS json))->>'VNED071ed') as vned071ed,
  ((cast(response AS json))->>'VNED071fc') as vned071fc,
  ((cast(response AS json))->>'VNED071j') as vned071j,
  ((cast(response AS json))->>'VNED071kd') as vned071kd,

  CASE WHEN ((cast(response AS json))->>'VNED073a') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073a') END as vned073a,
  CASE WHEN ((cast(response AS json))->>'VNED073ba') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073ba') END as vned073ba,
  CASE WHEN ((cast(response AS json))->>'VNED073bb') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073bb') END as vned073bb,
  CASE WHEN ((cast(response AS json))->>'VNED073bc') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073bc') END as vned073bc,
  CASE WHEN ((cast(response AS json))->>'VNED073bd') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073bd') END as vned073bd,
  CASE WHEN ((cast(response AS json))->>'VNED073be') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073be') END as vned073be,
  CASE WHEN ((cast(response AS json))->>'VNED073ca') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073ca') END as vned073ca,
  CASE WHEN ((cast(response AS json))->>'VNED073cb') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073cb') END as vned073cb,
  CASE WHEN ((cast(response AS json))->>'VNED073cc') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073cc') END as vned073cc,
  CASE WHEN ((cast(response AS json))->>'VNED073da') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073da') END as vned073da,
  CASE WHEN ((cast(response AS json))->>'VNED073db') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073db') END as vned073db,
  CASE WHEN ((cast(response AS json))->>'VNED073dc') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073dc') END as vned073dc,
  CASE WHEN ((cast(response AS json))->>'VNED073dd') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073dd') END as vned073dd,
  CASE WHEN ((cast(response AS json))->>'VNED073de') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073de') END as vned073de,
  CASE WHEN ((cast(response AS json))->>'VNED073ea') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073ea') END as vned073ea,
  CASE WHEN ((cast(response AS json))->>'VNED073eb') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073eb') END as vned073eb,
  CASE WHEN ((cast(response AS json))->>'VNED073ec') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073ec') END as vned073ec,
  CASE WHEN ((cast(response AS json))->>'VNED073ed') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073ed') END as vned073ed,
  CASE WHEN ((cast(response AS json))->>'VNED073fa') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073fa') END as vned073fa,
  CASE WHEN ((cast(response AS json))->>'VNED073fb') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073fb') END as vned073fb,
  CASE WHEN ((cast(response AS json))->>'VNED073fc') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073fc') END as vned073fc,
  CASE WHEN ((cast(response AS json))->>'VNED073g') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073g') END as vned073g,
  CASE WHEN ((cast(response AS json))->>'VNED073h') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073h') END as vned073h,
  CASE WHEN ((cast(response AS json))->>'VNED073i') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073i') END as vned073i,
  CASE WHEN ((cast(response AS json))->>'VNED073j') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073j') END as vned073j,
  CASE WHEN ((cast(response AS json))->>'VNED073ka') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073ka') END as vned073ka,
  CASE WHEN ((cast(response AS json))->>'VNED073kb') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073kb') END as vned073kb,
  CASE WHEN ((cast(response AS json))->>'VNED073kc') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073kc') END as vned073kc,
  CASE WHEN ((cast(response AS json))->>'VNED073kd') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED073kd') END as vned073kd,
  
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075a]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075a]') END as VYED075a,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075b]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075b]') END as VYED075b,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075c]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075c]') END as VYED075c,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075d]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075d]') END as VYED075d,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075e]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075e]') END as VYED075e,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075f]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075f]') END as VYED075f,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075g]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075g]') END as VYED075g,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075h]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075h]') END as VYED075h,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075i]') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'QYED075[VYED075i]') END as VYED075i,
  
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075a]') = '999' THEN '-1' ELSE NULL END as VYED076a,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075b]') = '999' THEN '-1' ELSE NULL END as VYED076b,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075c]') = '999' THEN '-1' ELSE NULL END as VYED076c,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075d]') = '999' THEN '-1' ELSE NULL END as VYED076d,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075e]') = '999' THEN '-1' ELSE NULL END as VYED076e,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075f]') = '999' THEN '-1' ELSE NULL END as VYED076f,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075g]') = '999' THEN '-1' ELSE NULL END as VYED076g,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075h]') = '999' THEN '-1' ELSE NULL END as VYED076h,
  CASE WHEN ((cast(response AS json))->>'QYED075[VYED075i]') = '999' THEN '-1' ELSE NULL END as VYED076i,
  
  CASE WHEN ((cast(response AS json))->>'VNED010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED010') END as vned010,
  CASE WHEN ((cast(response AS json))->>'VNED015') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED015') END as vned015,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016x]') END as VNED016x,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016a]') END as vned016a,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016b]') END as vned016b,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016c]') END as vned016c,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016d]') END as vned016d,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016e]') END as vned016e,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016f]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016f]') END as vned016f,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016g]') END as vned016g,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016h]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016h]') END as vned016h,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016i]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016i]') END as vned016i,
  CASE WHEN ((cast(response AS json))->>'QNED016[VNED016j]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QNED016[VNED016j]') END as vned016j,
  CASE WHEN ((cast(response AS json))->>'VNED025') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED025') END as vned025,
  CASE WHEN ((cast(response AS json))->>'VNED030') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED030') END as vned030,

  ((cast(response AS json))->>'VNED031') as vned031,

  CASE WHEN ((cast(response AS json))->>'VMED040') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VMED040') END as VMED040,
  CASE WHEN ((cast(response AS json))->>'VMED040') = '999' THEN '-1' ELSE NULL END as VMED041,
  CASE WHEN ((cast(response AS json))->>'VMED050') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VMED050') END as VMED050,
  CASE WHEN ((cast(response AS json))->>'VMED050') = '999' THEN '-1' ELSE NULL END as VMED051,
  CASE WHEN ((cast(response AS json))->>'VMED060') = '999' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VMED060') END as VMED060,
  CASE WHEN ((cast(response AS json))->>'VMED060') = '999' THEN '-1' ELSE NULL END as VMED061,
  CASE WHEN ((cast(response AS json))->>'VZEO010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEO010') END as vzeo010,

  ((cast(response AS json))->>'VZEO011') as vzeo011,

  CASE WHEN ((cast(response AS json))->>'VNED026') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED026') END as vned026,

  ((cast(response AS json))->>'VMED045') as vmed045,

  CASE WHEN ((cast(response AS json))->>'VMED046') = '999' THEN '-1' WHEN '1' THEN 'SYSMIS' ELSE NULL END as VMED046,

  ((cast(response AS json))->>'VMED055') as vmed055,

  CASE WHEN ((cast(response AS json))->>'VMED056') = '999' THEN '-1' WHEN '1' THEN 'SYSMIS' ELSE NULL END as VMED056,

  ((cast(response AS json))->>'VMED065') as vmed065,

  CASE WHEN ((cast(response AS json))->>'VMED066') = '999' THEN '-1' WHEN '1' THEN 'SYSMIS' ELSE NULL END as VMED066,
  CASE WHEN ((cast(response AS json))->>'VZEA010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA010') END as vzea010,
  CASE WHEN ((cast(response AS json))->>'VZEA020') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA020') END as vzea020,
  CASE WHEN ((cast(response AS json))->>'VZEA030') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA030') END as vzea030,
  CASE WHEN ((cast(response AS json))->>'VZEA040') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA040') END as vzea040,
  CASE WHEN ((cast(response AS json))->>'VZEA050') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA050') END as vzea050,
  CASE WHEN ((cast(response AS json))->>'VZEA060') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA060') END as vzea060,
  CASE WHEN ((cast(response AS json))->>'VZEA070') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA070') END as vzea070,
  CASE WHEN ((cast(response AS json))->>'VZEA080') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA080') END as vzea080,
  CASE WHEN ((cast(response AS json))->>'VZEA090') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA090') END as vzea090,
  CASE WHEN ((cast(response AS json))->>'VZEA100') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA100') END as vzea100,

  NULL as vzea110,
  NULL as VZEA111,

  ((cast(response AS json))->>'QZEA120[VZEA120a]') as qzea120_vzea120a,
  ((cast(response AS json))->>'QZEA120[VZEA120b]') as qzea120_vzea120b,
  ((cast(response AS json))->>'QZEA120[VZEA120c]') as qzea120_vzea120c,
  ((cast(response AS json))->>'QZEA120[VZEA120d]') as qzea120_vzea120d,
  ((cast(response AS json))->>'QZEA120[VZEA120e]') as qzea120_vzea120e,
  ((cast(response AS json))->>'QZEA120[VZEA120f]') as qzea120_vzea120f,
  ((cast(response AS json))->>'QZEA120[VZEA120g]') as qzea120_vzea120g,
  ((cast(response AS json))->>'QZEA120[VZEA120h]') as qzea120_vzea120h,
  ((cast(response AS json))->>'QZEA120[VZEA120i]') as qzea120_vzea120i,
  ((cast(response AS json))->>'QZEA120[VZEA120j]') as qzea120_vzea120j,

  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120a]') = '0' THEN '1' ELSE NULL END as VZEA121a,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120b]') = '0' THEN '1' ELSE NULL END as VZEA121b,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120c]') = '0' THEN '1' ELSE NULL END as VZEA121c,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120d]') = '0' THEN '1' ELSE NULL END as VZEA121d,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120e]') = '0' THEN '1' ELSE NULL END as VZEA121e,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120f]') = '0' THEN '1' ELSE NULL END as VZEA121f,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120g]') = '0' THEN '1' ELSE NULL END as VZEA121g,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120h]') = '0' THEN '1' ELSE NULL END as VZEA121h,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120i]') = '0' THEN '1' ELSE NULL END as VZEA121i,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120j]') = '0' THEN '1' ELSE NULL END as VZEA121j,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120a]') = '' THEN '-1' ELSE NULL END as VZEA122a,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120b]') = '' THEN '-1' ELSE NULL END as VZEA122b,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120c]') = '' THEN '-1' ELSE NULL END as VZEA122c,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120d]') = '' THEN '-1' ELSE NULL END as VZEA122d,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120e]') = '' THEN '-1' ELSE NULL END as VZEA122e,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120f]') = '' THEN '-1' ELSE NULL END as VZEA122f,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120g]') = '' THEN '-1' ELSE NULL END as VZEA122g,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120h]') = '' THEN '-1' ELSE NULL END as VZEA122h,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120i]') = '' THEN '-1' ELSE NULL END as VZEA122i,
  CASE WHEN ((cast(response AS json))->>'QZEA120[VZEA120j]') = '' THEN '-1' ELSE NULL END as VZEA122j,
  
  CASE WHEN ((cast(response AS json))->>'VZEA130') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA130') END as vzea130,

  ((cast(response AS json))->>'VZEA135') as vzea135,

  CASE WHEN ((cast(response AS json))->>'VZEA136') = '999' THEN '-1' WHEN '1' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VZEA136') END as VZEA136,
  CASE WHEN ((cast(response AS json))->>'VZEA140') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEA140') END as vzea140,
  CASE WHEN ((cast(response AS json))->>'VZET010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZET010') END as vzet010,
  CASE WHEN ((cast(response AS json))->>'VZET020') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZET020') END as vzet020,
  CASE WHEN ((cast(response AS json))->>'VZET030') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZET030') END as vzet030,
  CASE WHEN ((cast(response AS json))->>'VZET040') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZET040') END as vzet040,
  CASE WHEN ((cast(response AS json))->>'VZET050') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZET050') END as vzet050,
  CASE WHEN ((cast(response AS json))->>'VZET060') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZET060') END as vzet060,
  CASE WHEN ((cast(response AS json))->>'VZET070') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZET070') END as vzet070,

  NULL as vzet080,
  NULL as VZET081,

  CASE WHEN ((cast(response AS json))->>'VNED090') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED090') END as vned090,
  CASE WHEN ((cast(response AS json))->>'VNED093') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED093') END as vned093,
  CASE WHEN ((cast(response AS json))->>'VNED095') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED095') END as vned095,

  ((cast(response AS json))->>'VMED096') as vmed096,

  CASE WHEN ((cast(response AS json))->>'VMED097') = '999' THEN '-1' WHEN '1' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VMED097') END as vmed097,
  CASE WHEN ((cast(response AS json))->>'VNED092') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED092') END as vned092,
  CASE WHEN ((cast(response AS json))->>'VNED094') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED094') END as vned094,
  CASE WHEN ((cast(response AS json))->>'VNED098') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VNED098') END as VNED098,
  CASE WHEN ((cast(response AS json))->>'VZEU010') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEU010') END as vzeu010,

  ((cast(response AS json))->>'QZEU011') as vzeu011,

  CASE WHEN ((cast(response AS json))->>'VZEU020') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VZEU020') END as vzeu020,
  CASE WHEN ((cast(response AS json))->>'QZEU025[VZEU025x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU025[VZEU025x]') END as VZEU025x,
  CASE WHEN ((cast(response AS json))->>'QZEU025[VZEU025a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU025[VZEU025a]') END as VZEU025a,
  CASE WHEN ((cast(response AS json))->>'QZEU025[VZEU025b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU025[VZEU025b]') END as VZEU025b,
  CASE WHEN ((cast(response AS json))->>'QZEU025[VZEU025c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU025[VZEU025c]') END as VZEU025c,
  CASE WHEN ((cast(response AS json))->>'QZEU025[VZEU025d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU025[VZEU025d]') END as VZEU025d,

  ((cast(response AS json))->>'VZEU030') as vzeu030,

  CASE WHEN ((cast(response AS json))->>'VZEU031') = '999' THEN '-1' WHEN '1' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VZEU031') END as VZEU031,

  ((cast(response AS json))->>'VZEU040') as vzeu040,

  CASE WHEN ((cast(response AS json))->>'VZEU041') = '999' THEN '-1' WHEN '1' THEN 'SYSMIS' ELSE ((cast(response AS json))->>'VZEU041') END as VZEU041,

  NULL as vzeu050,
  NULL as VZEU051,

  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070x]') END as VZEU070x,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070y]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070y]') END as VZEU070y,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070a]') END as VZEU070a,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070b]') END as VZEU070b,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070c]') END as VZEU070c,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070d]') END as VZEU070d,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070e]') END as VZEU070e,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070f]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070f]') END as VZEU070f,
  CASE WHEN ((cast(response AS json))->>'QZEU070[VZEU070g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEU070[VZEU070g]') END as VZEU070g,

  ((cast(response AS json))->>'VZEU071') as vzeu071,

  CASE WHEN ((cast(response AS json))->>'VYEK040') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEK040') END as vyek040,
  CASE WHEN ((cast(response AS json))->>'VYEK041') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEK041') END as vyek041,
  CASE WHEN ((cast(response AS json))->>'VYEK060') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEK060') END as vyek060,
  CASE WHEN ((cast(response AS json))->>'VYEK061') = '999' THEN '-1' ELSE ((cast(response AS json))->>'VYEK061') END as vyek061,
  
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010x]') END as VZEK010x,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010y]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010y]') END as vzek010y,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010a]') END as vzek010a,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010b]') END as vzek010b,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010c]') END as vzek010c,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010d]') END as vzek010d,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010e]') END as vzek010e,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010f]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010f]') END as vzek010f,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010g]') END as vzek010g,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010h]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010h]') END as vzek010h,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010i]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010i]') END as vzek010i,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010j]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010j]') END as vzek010j,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010k]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010k]') END as vzek010k,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010l]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010l]') END as vzek010l,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010m]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010m]') END as vzek010m,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010n]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010n]') END as vzek010n,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010o]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010o]') END as vzek010o,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010p]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010p]') END as vzek010p,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010q]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010q]') END as vzek010q,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010r]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010r]') END as vzek010r,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010s]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010s]') END as vzek010s,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010t]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010t]') END as vzek010t,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010u]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010u]') END as vzek010u,
  CASE WHEN ((cast(response AS json))->>'QZEK010[VZEK010v]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QZEK010[VZEK010v]') END as vzek010v,

  ((cast(response AS json))->>'VZEK011') as vzek011,

  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010x]') END as VYEP010x,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010y]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010y]') END as vyep010y,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010a]') END as vyep010a,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010b]') END as vyep010b,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010c]') END as vyep010c,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010d]') END as vyep010d,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010e]') END as vyep010e,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010f]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010f]') END as vyep010f,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010g]') END as vyep010g,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010h]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010h]') END as vyep010h,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010i]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010i]') END as vyep010i,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010j]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010j]') END as vyep010j,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010k]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010k]') END as vyep010k,
  CASE WHEN ((cast(response AS json))->>'QYEP010[VYEP010l]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP010[VYEP010l]') END as vyep010l,

  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012x]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012x]') END as vyep012x,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012y]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012y]') END as vyep012y,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012a]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012a]') END as vyep012a,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012b]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012b]') END as vyep012b,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012c]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012c]') END as vyep012c,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012d]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012d]') END as vyep012d,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012e]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012e]') END as vyep012e,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012f]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012f]') END as vyep012f,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012g]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012g]') END as vyep012g,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012h]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012h]') END as vyep012h,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012i]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012i]') END as vyep012i,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012j]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012j]') END as vyep012j,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012k]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012k]') END as vyep012k,
  CASE WHEN ((cast(response AS json))->>'QYEP012[VYEP012l]') = 'Y' THEN '1' ELSE ((cast(response AS json))->>'QYEP012[VYEP012l]') END as vyep012l


FROM "survey_response_view" 
LEFT JOIN patient ON(survey_response_view.patient_id = patient.id) 
LEFT JOIN stay ON(survey_response_view.stay_id = stay.id) 

WHERE module = 'ch.suedhang.apps.actinfo_ein.production';
