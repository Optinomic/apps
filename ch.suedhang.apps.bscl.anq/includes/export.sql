SELECT 
  patient.id AS pid,
  patient,
  ((cast(response AS json))->>'id') as id_limesurvey,
  id as id_
  ((cast(response AS json))->>'FID') as fid,
  ((cast(response AS json))->>'q501V04') as q501v04,
  ((cast(response AS json))->>'q501V05') as q501v05,
  ((cast(response AS json))->>'q501V06') as q501v06,
  TO_CHAR(TO_DATE(((cast(response AS json))->>'q504V00'), 'YYYYMMDD'), 'YYYYMMDD')  as q504V00,
  ((cast(response AS json))->>'BSCL[sq504V01]') as bscl_sq504v01,
  ((cast(response AS json))->>'BSCL[sq504V02]') as bscl_sq504v02,
  ((cast(response AS json))->>'BSCL[sq504V03]') as bscl_sq504v03,
  ((cast(response AS json))->>'BSCL[sq504V04]') as bscl_sq504v04,
  ((cast(response AS json))->>'BSCL[sq504V05]') as bscl_sq504v05,
  ((cast(response AS json))->>'BSCL[sq504V06]') as bscl_sq504v06,
  ((cast(response AS json))->>'BSCL[sq504V07]') as bscl_sq504v07,
  ((cast(response AS json))->>'BSCL[sq504V08]') as bscl_sq504v08,
  ((cast(response AS json))->>'BSCL[sq504V09]') as bscl_sq504v09,
  ((cast(response AS json))->>'BSCL[sq504V10]') as bscl_sq504v10,
  ((cast(response AS json))->>'BSCL[sq504V11]') as bscl_sq504v11,
  ((cast(response AS json))->>'BSCL[sq504V12]') as bscl_sq504v12,
  ((cast(response AS json))->>'BSCL[sq504V13]') as bscl_sq504v13,
  ((cast(response AS json))->>'BSCL[sq504V14]') as bscl_sq504v14,
  ((cast(response AS json))->>'BSCL[sq504V15]') as bscl_sq504v15,
  ((cast(response AS json))->>'BSCL[sq504V16]') as bscl_sq504v16,
  ((cast(response AS json))->>'BSCL[sq504V17]') as bscl_sq504v17,
  ((cast(response AS json))->>'BSCL[sq504V18]') as bscl_sq504v18,
  ((cast(response AS json))->>'BSCL[sq504V19]') as bscl_sq504v19,
  ((cast(response AS json))->>'BSCL[sq504V20]') as bscl_sq504v20,
  ((cast(response AS json))->>'BSCL[sq504V21]') as bscl_sq504v21,
  ((cast(response AS json))->>'BSCL[sq504V22]') as bscl_sq504v22,
  ((cast(response AS json))->>'BSCL[sq504V23]') as bscl_sq504v23,
  ((cast(response AS json))->>'BSCL[sq504V24]') as bscl_sq504v24,
  ((cast(response AS json))->>'BSCL[sq504V25]') as bscl_sq504v25,
  ((cast(response AS json))->>'BSCL[sq504V26]') as bscl_sq504v26,
  ((cast(response AS json))->>'BSCL[sq504V27]') as bscl_sq504v27,
  ((cast(response AS json))->>'BSCL[sq504V28]') as bscl_sq504v28,
  ((cast(response AS json))->>'BSCL[sq504V29]') as bscl_sq504v29,
  ((cast(response AS json))->>'BSCL[sq504V30]') as bscl_sq504v30,
  ((cast(response AS json))->>'BSCL[sq504V31]') as bscl_sq504v31,
  ((cast(response AS json))->>'BSCL[sq504V32]') as bscl_sq504v32,
  ((cast(response AS json))->>'BSCL[sq504V33]') as bscl_sq504v33,
  ((cast(response AS json))->>'BSCL[sq504V34]') as bscl_sq504v34,
  ((cast(response AS json))->>'BSCL[sq504V35]') as bscl_sq504v35,
  ((cast(response AS json))->>'BSCL[sq504V36]') as bscl_sq504v36,
  ((cast(response AS json))->>'BSCL[sq504V37]') as bscl_sq504v37,
  ((cast(response AS json))->>'BSCL[sq504V38]') as bscl_sq504v38,
  ((cast(response AS json))->>'BSCL[sq504V39]') as bscl_sq504v39,
  ((cast(response AS json))->>'BSCL[sq504V40]') as bscl_sq504v40,
  ((cast(response AS json))->>'BSCL[sq504V41]') as bscl_sq504v41,
  ((cast(response AS json))->>'BSCL[sq504V42]') as bscl_sq504v42,
  ((cast(response AS json))->>'BSCL[sq504V43]') as bscl_sq504v43,
  ((cast(response AS json))->>'BSCL[sq504V44]') as bscl_sq504v44,
  ((cast(response AS json))->>'BSCL[sq504V45]') as bscl_sq504v45,
  ((cast(response AS json))->>'BSCL[sq504V46]') as bscl_sq504v46,
  ((cast(response AS json))->>'BSCL[sq504V47]') as bscl_sq504v47,
  ((cast(response AS json))->>'BSCL[sq504V48]') as bscl_sq504v48,
  ((cast(response AS json))->>'BSCL[sq504V49]') as bscl_sq504v49,
  ((cast(response AS json))->>'BSCL[sq504V50]') as bscl_sq504v50,
  ((cast(response AS json))->>'BSCL[sq504V51]') as bscl_sq504v51,
  ((cast(response AS json))->>'BSCL[sq504V52]') as bscl_sq504v52,
  ((cast(response AS json))->>'BSCL[sq504V53]') as bscl_sq504v53,
  TO_DATE(((cast(response AS json))->>'q504V00'), 'YYYY-MM-DD HH24:MI:SS')  as datestamp_date,

  ((cast(response AS json))->>'Eintrittsort') as eintrittsort,
  ((cast(response AS json))->>'Austrittsort') as austrittsort,
  ((cast(response AS json))->>'PID') as pid,
  ((cast(response AS json))->>'datestamp') as datestamp,

FROM survey_response INNER JOIN patient ON(survey_response.patient = patient.id) 
WHERE module = 'ch.suedhang.apps.bscl.anq'
ORDER BY q501V04 
